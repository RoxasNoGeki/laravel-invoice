<?php

namespace App\Models;

// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
// LARAVEL
// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
use App\Events\Template\Registering_Ref;
use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\SoftDeletes;



use Carbon\Carbon;

class Template extends Model
{
    use SoftDeletes;

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // VARIABLES
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    protected $table    = 'Inv_template';
    public $timestamps  = true;
    protected $fillable = [
        'issuer',
        'billed_to',
        'lines',
        'prefix_no',
        'payment_option',
        'send_option',
        'payment_terms',
        'repeat_in_days',
        'repeat_in_months',
        'due_in_days',
        'due_in_months',
        'user_id',
        'layout'
    ];
    protected $hidden = [
    ];
    protected $casts = [
        'issuer' =>'array',
        'billed_to' =>'array',
        'payment_option' =>'array',
        'payment_terms' =>'array'
    ];

    protected $dates = [
        'deleted_at'
    ];

    protected $touches = [
    ];

    protected $dispatchesEvents = [
        'creating'=>Registering_Ref::class

    ];




    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // BOOT
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // CONSTRUCT
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // RELATIONSHIP
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    public function history(){
       return $this->hasMany('App\Models\History','no','prefix_no');
    }
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // BOOT
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // STATIC FUNCTION
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // FUNCTION
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    public function getRules()
    {
        return [
            'name'       	=> ['required', 'string'],
            'period'      	=> ['required', 'numeric'],
            'published_at' 	=> ['nullable', 'date', 'after:now'],
        ];
    }

    public function getRelationships()
    {
        return [];
    }

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // ACCESSOR
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // MUTATOR
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // QUERY
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

}
